# 🚀 AWS S3 托管 Logo 完整指南

将 logo 文件托管到 bigfootws.com 的完整步骤。

---

## 📋 准备工作

需要准备：
- ✅ AWS 账号（新账号有 12 个月免费套餐）
- ✅ bigfootws.com 域名访问权限
- ✅ 信用卡（注册用，免费套餐内不会扣费）

---

## 第一部分：注册 AWS 免费账号

### 步骤 1: 访问 AWS 官网
1. 打开 https://aws.amazon.com/
2. 点击右上角 **"创建 AWS 账户"** 或 **"Create an AWS Account"**

### 步骤 2: 填写账户信息
1. **电邮地址**：输入您的邮箱
2. **AWS 账户名称**：例如 `BigFootWS`
3. 点击 **"验证电子邮箱地址"**
4. 检查邮箱，输入验证码

### 步骤 3: 设置密码
1. 创建一个强密码
2. 确认密码
3. 点击 **"继续"**

### 步骤 4: 填写联系信息
1. **账户类型**：选择 **"个人"**
2. 填写：
   - 全名
   - 电话号码
   - 地址
3. 勾选 **AWS 客户协议**
4. 点击 **"创建账户并继续"**

### 步骤 5: 添加付款信息
1. 输入信用卡信息
2. **注意**：只要在免费套餐限额内，不会扣费
3. AWS 会验证扣除 $1 USD（稍后退回）

### 步骤 6: 验证身份
1. 选择验证方式：**短信** 或 **语音通话**
2. 输入电话号码
3. 收到验证码后输入
4. 点击 **"继续"**

### 步骤 7: 选择支持计划
1. 选择 **"基本支持 - 免费"**
2. 点击 **"完成注册"**

✅ **注册完成！** 您现在有了 AWS 账户。

---

## 第二部分：创建 S3 存储桶

### 步骤 1: 登录 AWS 控制台
1. 访问 https://console.aws.amazon.com/
2. 使用刚注册的账号登录

### 步骤 2: 打开 S3 服务
1. 在顶部搜索栏输入 **"S3"**
2. 点击 **"S3"** 进入服务

### 步骤 3: 创建存储桶
1. 点击 **"创建存储桶"** 按钮
2. 填写配置：

   **存储桶名称**：
   ```
   bigfootws-logos
   ```
   （必须全球唯一，可以加上日期如 `bigfootws-logos-2026`）

   **AWS 区域**：
   - 选择 **"亚太地区（香港）ap-east-1"**
   - 或 **"亚太地区（新加坡）ap-southeast-1"**
   （距离香港近，速度快）

3. **对象所有权**：
   - 选择 **"ACL 已启用"**

4. **阻止公共访问设置**：
   - ⚠️ **取消勾选** "阻止所有公共访问"
   - 勾选确认框：**"我了解当前设置可能会导致此存储桶及其中的对象变为公开"**

5. **存储桶版本控制**：
   - 保持 **"停用"**

6. **默认加密**：
   - 保持默认设置

7. 点击 **"创建存储桶"**

✅ **存储桶创建完成！**

---

## 第三部分：上传 Logo 文件

### 步骤 1: 进入存储桶
1. 在 S3 控制台中，点击刚创建的存储桶名称 `bigfootws-logos`

### 步骤 2: 创建文件夹结构（可选）
1. 点击 **"创建文件夹"**
2. 输入文件夹名：`logos`
3. 点击 **"创建文件夹"**
4. 进入 `logos` 文件夹

### 步骤 3: 上传 Logo 文件
1. 点击 **"上传"** 按钮
2. 点击 **"添加文件"**
3. 选择您的 logo 文件（例如从 `public/logos/` 目录）
4. 可以一次选择多个文件上传
5. 点击 **"上传"**
6. 等待上传完成
7. 点击 **"关闭"**

✅ **文件上传完成！**

---

## 第四部分：设置公开访问权限

### 步骤 1: 选择所有文件
1. 在存储桶中，勾选所有上传的文件
2. 或者进入 `logos` 文件夹，勾选所有文件

### 步骤 2: 设置权限
1. 点击 **"操作"** 下拉菜单
2. 选择 **"使用 ACL 公开"**
3. 在弹出窗口中，点击 **"公开"**

### 步骤 3: 编辑存储桶策略（重要！）
1. 返回存储桶主页
2. 点击 **"权限"** 标签
3. 向下滚动到 **"存储桶策略"**
4. 点击 **"编辑"**
5. 粘贴以下策略（替换 `bigfootws-logos` 为您的存储桶名称）：

```json
{
    "Version": "2012-10-17",
    "Statement": [
        {
            "Sid": "PublicReadGetObject",
            "Effect": "Allow",
            "Principal": "*",
            "Action": "s3:GetObject",
            "Resource": "arn:aws:s3:::bigfootws-logos/*"
        }
    ]
}
```

6. 点击 **"保存更改"**

✅ **文件现在可以公开访问了！**

---

## 第五部分：测试访问

### 步骤 1: 获取文件 URL
1. 在存储桶中点击任意文件
2. 复制 **"对象 URL"**
3. 格式类似：
   ```
   https://bigfootws-logos.s3.ap-east-1.amazonaws.com/logos/parknshop.jpg
   ```

### 步骤 2: 在浏览器测试
1. 在浏览器新标签页粘贴 URL
2. 如果能看到图片，说明设置成功！✅

---

## 第六部分：绑定自定义域名 (bigfootws.com)

### 方法A：使用 CloudFront + 自定义域名（推荐）

#### 步骤 1: 创建 CloudFront 分配
1. 在 AWS 控制台搜索 **"CloudFront"**
2. 点击 **"创建分配"**

3. **源设置**：
   - **源域**：选择您的 S3 存储桶 `bigfootws-logos.s3.ap-east-1.amazonaws.com`
   - **源路径**：留空 或 输入 `/logos`
   - **名称**：自动生成

4. **默认缓存行为**：
   - **查看器协议策略**：选择 **"Redirect HTTP to HTTPS"**
   - **允许的 HTTP 方法**：**GET, HEAD**
   - 其他保持默认

5. **设置**：
   - **备用域名(CNAME)**：输入 `logos.bigfootws.com`
   - **自定义 SSL 证书**：稍后配置（需要先申请证书）

6. 暂时跳过 SSL，点击 **"创建分配"**

#### 步骤 2: 申请 SSL 证书（AWS Certificate Manager）
1. 在 AWS 控制台搜索 **"Certificate Manager"**
2. ⚠️ **重要**：切换区域到 **"美国东部(弗吉尼亚北部) us-east-1"**
   （CloudFront 只能使用这个区域的证书）
3. 点击 **"申请证书"**
4. 选择 **"申请公有证书"**
5. 输入域名：
   ```
   logos.bigfootws.com
   ```
6. **验证方法**：选择 **"DNS 验证"**
7. 点击 **"申请"**

#### 步骤 3: 完成 DNS 验证
1. 在证书详情页面，展开域名
2. 复制 **CNAME 名称** 和 **CNAME 值**
3. 前往您的域名 DNS 管理面板（bigfootws.com 的注册商）
4. 添加 CNAME 记录：
   - **名称/主机**：（粘贴 CNAME 名称，去掉域名部分）
   - **值/指向**：（粘贴 CNAME 值）
   - **TTL**：默认
5. 保存
6. 等待 5-30 分钟，证书状态变为 **"已颁发"**

#### 步骤 4: 将证书绑定到 CloudFront
1. 返回 CloudFront 分配列表
2. 选择刚创建的分配，点击 **"编辑"**
3. **自定义 SSL 证书**：选择刚申请的证书
4. 点击 **"保存更改"**

#### 步骤 5: 配置 DNS CNAME
1. 前往域名 DNS 管理面板
2. 添加 CNAME 记录：
   - **名称/主机**：`logos`
   - **值/指向**：CloudFront 分配域名（例如 `d1234abcd.cloudfront.net`）
   - **TTL**：默认
3. 保存

### 方法B：直接使用 S3 静态网站（较简单但无 HTTPS）

#### 步骤 1: 启用静态网站托管
1. 进入 S3 存储桶
2. 点击 **"属性"** 标签
3. 向下滚动到 **"静态网站托管"**
4. 点击 **"编辑"**
5. 选择 **"启用"**
6. **索引文档**：`index.html`（可选）
7. 点击 **"保存更改"**
8. 复制 **"存储桶网站终端节点"**
   例如：`http://bigfootws-logos.s3-website.ap-east-1.amazonaws.com`

#### 步骤 2: 配置 DNS CNAME
1. 前往域名 DNS 管理面板
2. 添加 CNAME 记录：
   - **名称/主机**：`logos`
   - **值/指向**：S3 网站终端节点（去掉 `http://`）
   - **TTL**：默认
3. 保存

⚠️ **注意**：此方法只支持 HTTP，不支持 HTTPS

---

## 第七部分：更新应用中的 Logo 路径

### 更新 merchants.json

将 logo 路径改为 CDN URL：

```json
{
    "name": "百佳",
    "name_en": "PARKnSHOP",
    "logo": "https://logos.bigfootws.com/parknshop.jpg",
    "instagram_id": "hkparknshop"
}
```

或者使用 CloudFront URL：
```json
{
    "logo": "https://d1234abcd.cloudfront.net/logos/parknshop.jpg"
}
```

---

## 💰 费用说明

### AWS 免费套餐（12个月）
- **S3**：5 GB 存储
- **CloudFront**：50 GB 数据传输/月
- **证书**：免费（ACM）

### Logo 文件估算
- 18个商家 × 平均 50KB = 900KB
- 远低于 5GB 限额 ✅

### 超出免费套餐后
- **S3**: ~$0.023/GB/月
- **CloudFront**: ~$0.085/GB（亚太区）
- 对于 logo 托管来说，每月费用 < $1 USD

---

## 🎯 快速checklist

- [ ] 注册 AWS 账号
- [ ] 创建 S3 存储桶
- [ ] 上传 logo 文件
- [ ] 设置公开访问权限
- [ ] 申请 SSL 证书（可选）
- [ ] 创建 CloudFront 分配（可选）
- [ ] 配置 DNS CNAME
- [ ] 测试访问
- [ ] 更新应用中的 logo 路径

---

## 🆘 常见问题

### Q: 文件无法访问，显示 403 错误？
**A**: 检查存储桶策略是否正确设置，确保 "阻止公共访问" 已关闭。

### Q: DNS 配置后无法访问？
**A**: DNS 生效需要时间，通常 5-60 分钟。可以用 `nslookup logos.bigfootws.com` 检查。

### Q: CloudFront 是否必需？
**A**: 不必需，但推荐使用因为：
- 支持 HTTPS
- 全球 CDN 加速
- 免费套餐包含 50GB/月

### Q: 如何监控免费套餐使用量？
**A**: AWS 控制台 → Billing → Free Tier → 查看使用情况

---

## 📞 需要帮助？

如果遇到任何问题，随时告诉我具体在哪一步卡住了！
